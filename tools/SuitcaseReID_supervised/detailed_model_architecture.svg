<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<svg width="1200" height="800" xmlns="http://www.w3.org/2000/svg">
    <!-- Background -->
    <rect width="1200" height="800" fill="#ffffff"/>
    <text x="600" y="40" font-family="Arial" font-size="24" text-anchor="middle" font-weight="bold">Detailed Model Architecture for SuitcaseReID</text>
    
    <!-- ResNet50 Backbone Structure -->
    <rect x="50" y="80" width="1100" height="300" fill="#f6f8fa" stroke="#24292e" stroke-width="2" rx="5"/>
    <text x="600" y="100" font-family="Arial" font-size="20" text-anchor="middle" font-weight="bold" fill="#24292e">ResNet50 Backbone Architecture</text>
    
    <!-- Conv1 Block -->
    <rect x="70" y="120" width="120" height="80" fill="#ddf4ff" stroke="#0969da" stroke-width="1" rx="3"/>
    <text x="130" y="145" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">Conv1</text>
    <text x="130" y="165" font-family="Arial" font-size="12" text-anchor="middle">7×7, 64, /2</text>
    <text x="130" y="185" font-family="Arial" font-size="12" text-anchor="middle">BN, ReLU</text>
    
    <!-- MaxPool -->
    <rect x="210" y="120" width="100" height="80" fill="#ddf4ff" stroke="#0969da" stroke-width="1" rx="3"/>
    <text x="260" y="145" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">MaxPool</text>
    <text x="260" y="165" font-family="Arial" font-size="12" text-anchor="middle">3×3, /2</text>
    
    <!-- Conv2_x -->
    <rect x="330" y="120" width="160" height="80" fill="#ddf4ff" stroke="#0969da" stroke-width="1" rx="3"/>
    <text x="410" y="140" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">Conv2_x × 3</text>
    <text x="410" y="160" font-family="Arial" font-size="12" text-anchor="middle">1×1, 64</text>
    <text x="410" y="175" font-family="Arial" font-size="12" text-anchor="middle">3×3, 64</text>
    <text x="410" y="190" font-family="Arial" font-size="12" text-anchor="middle">1×1, 256</text>
    
    <!-- Conv3_x -->
    <rect x="510" y="120" width="160" height="80" fill="#ddf4ff" stroke="#0969da" stroke-width="1" rx="3"/>
    <text x="590" y="140" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">Conv3_x × 4</text>
    <text x="590" y="160" font-family="Arial" font-size="12" text-anchor="middle">1×1, 128</text>
    <text x="590" y="175" font-family="Arial" font-size="12" text-anchor="middle">3×3, 128</text>
    <text x="590" y="190" font-family="Arial" font-size="12" text-anchor="middle">1×1, 512</text>
    
    <!-- Conv4_x -->
    <rect x="690" y="120" width="160" height="80" fill="#ddf4ff" stroke="#0969da" stroke-width="1" rx="3"/>
    <text x="770" y="140" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">Conv4_x × 6</text>
    <text x="770" y="160" font-family="Arial" font-size="12" text-anchor="middle">1×1, 256</text>
    <text x="770" y="175" font-family="Arial" font-size="12" text-anchor="middle">3×3, 256</text>
    <text x="770" y="190" font-family="Arial" font-size="12" text-anchor="middle">1×1, 1024</text>
    
    <!-- Conv5_x -->
    <rect x="870" y="120" width="160" height="80" fill="#ddf4ff" stroke="#0969da" stroke-width="1" rx="3"/>
    <text x="950" y="140" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">Conv5_x × 3</text>
    <text x="950" y="160" font-family="Arial" font-size="12" text-anchor="middle">1×1, 512</text>
    <text x="950" y="175" font-family="Arial" font-size="12" text-anchor="middle">3×3, 512</text>
    <text x="950" y="190" font-family="Arial" font-size="12" text-anchor="middle">1×1, 2048</text>
    
    <!-- Feature Dimensions -->
    <text x="130" y="220" font-family="Arial" font-size="12" text-anchor="middle">256×128×64</text>
    <text x="410" y="220" font-family="Arial" font-size="12" text-anchor="middle">128×64×256</text>
    <text x="590" y="220" font-family="Arial" font-size="12" text-anchor="middle">64×32×512</text>
    <text x="770" y="220" font-family="Arial" font-size="12" text-anchor="middle">32×16×1024</text>
    <text x="950" y="220" font-family="Arial" font-size="12" text-anchor="middle">16×8×2048</text>
    
    <!-- Residual Connections -->
    <path d="M 70,260 L 1030,260" stroke="#0969da" stroke-width="2" stroke-dasharray="5,5" fill="none"/>
    <text x="550" y="280" font-family="Arial" font-size="14" text-anchor="middle" fill="#0969da">Identity Shortcuts (Residual Connections)</text>
    
    <!-- GeM Pooling Details -->
    <rect x="50" y="400" width="1100" height="140" fill="#f6f8fa" stroke="#24292e" stroke-width="2" rx="5"/>
    <text x="600" y="420" font-family="Arial" font-size="20" text-anchor="middle" font-weight="bold" fill="#24292e">Generalized Mean (GeM) Pooling</text>
    
    <!-- GeM Formula -->
    <rect x="70" y="440" width="300" height="80" fill="#fff" stroke="#24292e" stroke-width="1" rx="3"/>
    <text x="220" y="470" font-family="Arial" font-size="16" text-anchor="middle">f_gem = (1/|X| ∑ x_i^p)^(1/p)</text>
    <text x="220" y="490" font-family="Arial" font-size="14" text-anchor="middle">p = 3 (learnable parameter)</text>
    
    <!-- GeM Architecture -->
    <rect x="400" y="440" width="720" height="80" fill="#fff" stroke="#24292e" stroke-width="1" rx="3"/>
    <text x="760" y="465" font-family="Arial" font-size="14" text-anchor="middle" font-weight="bold">Input (16×8×2048) → Power Operation → Average → p-th Root → Output (2048)</text>
    <text x="760" y="490" font-family="Arial" font-size="12" text-anchor="middle">Adaptive to Feature Importance, Better than Global Average Pooling</text>
    
    <!-- Neck Structure -->
    <rect x="50" y="560" width="1100" height="220" fill="#f6f8fa" stroke="#24292e" stroke-width="2" rx="5"/>
    <text x="600" y="580" font-family="Arial" font-size="20" text-anchor="middle" font-weight="bold" fill="#24292e">Neck Structure</text>
    
    <!-- BN -->
    <rect x="70" y="600" width="200" height="60" fill="#ffebe9" stroke="#cf222e" stroke-width="1" rx="3"/>
    <text x="170" y="635" font-family="Arial" font-size="14" text-anchor="middle">Batch Normalization</text>
    
    <!-- Dropout -->
    <rect x="290" y="600" width="200" height="60" fill="#ffebe9" stroke="#cf222e" stroke-width="1" rx="3"/>
    <text x="390" y="625" font-family="Arial" font-size="14" text-anchor="middle">Dropout</text>
    <text x="390" y="645" font-family="Arial" font-size="12" text-anchor="middle">p = 0.3</text>
    
    <!-- Linear -->
    <rect x="510" y="600" width="200" height="60" fill="#ffebe9" stroke="#cf222e" stroke-width="1" rx="3"/>
    <text x="610" y="635" font-family="Arial" font-size="14" text-anchor="middle">Linear Layer (2048 → 2048)</text>
    
    <!-- Loss Functions -->
    <rect x="730" y="600" width="400" height="160" fill="#fff" stroke="#cf222e" stroke-width="1" rx="3"/>
    <text x="930" y="620" font-family="Arial" font-size="16" text-anchor="middle" font-weight="bold">Loss Functions</text>
    <line x1="750" y1="630" x2="1110" y2="630" stroke="#cf222e" stroke-width="1"/>
    <text x="930" y="650" font-family="Arial" font-size="14" text-anchor="middle">Cross Entropy Loss: L_ce = -∑y_i log(p_i)</text>
    <text x="930" y="680" font-family="Arial" font-size="14" text-anchor="middle">Triplet Loss: L_t = [d_p - d_n + m]_+</text>
    <text x="930" y="700" font-family="Arial" font-size="12" text-anchor="middle">margin m = 0.3</text>
    <text x="930" y="730" font-family="Arial" font-size="14" text-anchor="middle">Total Loss = L_ce + λL_t</text>
    <text x="930" y="750" font-family="Arial" font-size="12" text-anchor="middle">λ = 1.0</text>
    
    <!-- Arrows connecting components -->
    <line x1="270" y1="630" x2="290" y2="630" stroke="#cf222e" stroke-width="2" marker-end="url(#arrow)"/>
    <line x1="490" y1="630" x2="510" y2="630" stroke="#cf222e" stroke-width="2" marker-end="url(#arrow)"/>
    <line x1="710" y1="630" x2="730" y2="630" stroke="#cf222e" stroke-width="2" marker-end="url(#arrow)"/>
    
    <!-- Arrow marker definition -->
    <defs>
        <marker id="arrow" markerWidth="10" markerHeight="10" refX="9" refY="5" orient="auto">
            <path d="M0,0 L10,5 L0,10 z" fill="#cf222e"/>
        </marker>
    </defs>
</svg>
