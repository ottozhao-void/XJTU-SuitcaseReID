# 单视角无标签行李箱 ReID 模型开发报告

## 项目背景与挑战

我们利用 OpenUnReID 框架开发了一个适用于单视角无标签行李箱数据的 ReID（Re-identification）模型。与传统的 ReID 任务不同，我们面临以下挑战：

1. **单一视角**: 每个行李箱只有一个摄像头视角的图像，没有跨摄像头的多视角数据
2. **无身份标签**: 数据集没有提供行李箱的身份标签信息
3. **数据特性**: 行李箱之间的视觉特征差异可能不如行人明显

## 实施方案

我们采用了自步调对比学习（Self-paced Contrastive Learning, SpCL）算法，并对其进行了一系列适应性修改：

### 1. 数据集准备

- 将行李箱数据集按照 8:1:1 的比例分为训练、测试和查询三部分
- 创建了符合 OpenUnReID 框架要求的数据结构（`bounding_box_train`, `bounding_box_test`, `query`）
- 数据处理过程中为每个图像分配唯一的实例 ID，以便后续的聚类处理

### 2. 数据处理器优化

- 修改了 SuitcaseReID 数据处理器以适应单视角无标签场景
- 基于文件名模式实现了初始的"人工类别"分组
- 增强了对伪标签和离群点的处理逻辑
- 实现了高效的标签更新机制

### 3. 聚类参数调整

- DBSCAN 聚类参数（eps=[0.3, 0.4, 0.5]）经过调整以创建更多的聚类
- 减小 k 近邻参数（k1=10, k2=3）以实现更紧密的邻域匹配
- 对最小样本参数进行优化，以平衡聚类数量和质量

### 4. 增强的数据增广

- 启用了自动增广（Auto Augmentation）
- 增加了图像模糊处理（blur）以创造"人工"视角多样性
- 提高了随机擦除（Random Erase）的概率（0.7）以增加数据多样性

### 5. 训练流程优化

- 实现了聚类不足时的人工子聚类生成机制
- 添加了 StopIteration 异常处理，提高了训练的鲁棒性
- 增强了聚类统计报告功能，提供更详细的训练监控信息

## 评估与结果

由于单视角无标签的特殊性，我们采用了以下评估方法：

1. **聚类质量指标**：监控聚类数量、聚类大小分布及离群点比例
2. **检索性能**：通过 mAP（mean Average Precision）和 CMC（Cumulative Matching Characteristic）曲线评估模型检索性能
3. **特征可视化**：将学习到的特征嵌入到二维空间进行可视化，观察相似行李箱的聚集情况

## 存在的问题与改进方向

### 问题：

1. **聚类不稳定性**：初始阶段可能形成单一大聚类或过多小聚类
2. **特征区分性有限**：单视角数据使得模型难以学习到足够鲁棒的特征表示
3. **评估标准不明确**：缺乏真实标签导致难以客观评估模型性能

### 改进方向：

1. **预训练模型优化**：

   - 使用带有更多类别的预训练模型初始化（如使用 ImageNet-21K 预训练的 ResNet）
   - 可考虑在行人 ReID 数据上预训练后再迁移到行李箱

2. **聚类策略增强**：

   - 探索其他聚类算法（如 HDBSCAN、Spectral Clustering）
   - 实现多尺度聚类策略，综合不同粒度的聚类结果

3. **数据增强与生成**：

   - 使用 StyleGAN 或 DiffusionModels 生成多视角行李箱图像
   - 探索更强的数据增强策略，如 MixUp、CutMix 等

4. **半监督方案**：

   - 可以手动标注少量行李箱身份，引入半监督学习
   - 实现带标签数据与无标签数据的联合训练策略

5. **集成学习**：
   - 训练多个具有不同参数和随机种子的模型
   - 通过特征融合或投票机制提高检索稳定性

## 结论

我们成功地将 SpCL 算法适应到单视角无标签的行李箱 ReID 任务中，通过一系列的优化使模型能够学习有意义的特征表示。虽然面临一些挑战，但该方法为后续的改进和研究提供了有价值的基础。

未来的工作将集中在提高特征的区分性、增强聚类稳定性以及探索更合适的评估方法上，以进一步提升单视角无标签行李箱 ReID 的性能。
